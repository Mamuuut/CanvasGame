define(["PhysicEngine/Models/Vector2D","PhysicEngine/Models/QuadTree"],function(e,t){var n=function(r,i){function f(){l();var e=a.getMinTimeCollision();if(null!=e){s++,e.Collide();var t=e.getObjects(),n;for(var r=0,i=t.length;n=t[r],r<i;r++)a.update(n);f()}}function l(){var e;for(var t=0,n=o.length;e=o[t],t<n;t++)e.clearContacts()}var s,o=new Array,u=r,a=new t(0,0,u.canvas.width,u.canvas.height);this.addObject=function(e){o.push(e),a.insert(e)},this.removeObject=function(e){var t=o.indexOf(e);o.splice(t,1),a.remove(e)},this.clearObjects=function(){a.clear(),o=new Array},this.updatePhysic=function(){s=0,a.clear();var e;for(var t=0,n=o.length;e=o[t],t<n;t++)e.updateForces(),e.resetForces(),e.updateTimeNextPosition(0),e.parentQuads=new Array,a.insert(e);f();var e,r;for(var t=0,n=o.length;e=o[t],t<n;t++)e.updatePosition(),e.checkObjectIntersections(o)},this.getQuadTrees=function(){return a.getQuadTrees()},this.clearObjects(),n.GRAVITY=null!=i?i:new e(0,3)};return n.GRAVITY=new e,n})