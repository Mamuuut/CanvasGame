require(["./physic-engine"],function(){require(["app/main"])}),define("../physic-test",function(){}),define("app/ObjectView",[],function(){var e=function(e){_context=e,this.x=0,this.y=0,this.width=20,this.height=20,this.color="#000000",this.draw=function(){_context.fillStyle=this.color,_context.fillRect(this.x,this.y,this.width,this.height)}};return e}),define("app/LevelObject",[],function(){var e=function(e,t){var n=e,r=t;this.updateView=function(){n.x=r.position.x,n.y=r.position.y,n.width=r.size.x,n.height=r.size.y,n.draw()}};return e}),define("app/LevelController",["app/ObjectView","app/LevelObject","PhysicEngine/Controller/PhysicController","PhysicEngine/Models/Vector2D","PhysicEngine/Models/ObjectModel","PhysicEngine/Models/QuadTree","PhysicEngine/Events/EventTargetMixin","PhysicEngine/Events/PhysicEvents"],function(e,t,n,r,i,s,o,u){var a=20,f=function(o){var l=this,c=undefined,h=undefined,p=o,d=new n(o),v=[],m=0,g=0;this.pause=!0;var y=function(e){l.dispatchEvent(f.EVENT_COUNT_UPDATE,{collide:m,intersect:g})},b=function(e){m++,y()},w=function(e){g++,y()};this.clearLevel=function(){d.clearObjects(),v=[],m=0,g=0,y()},this.addRandomObjects=function(e){d.clearObjects(),n.GRAVITY=new r(0,0),i.AIR_FRICTION=1,i.CONTACT_FRICTION=new r(1,1),s.MAX_OBJECTS_PER_QUAD=10;for(var t=0;t<e;t++)this.addRandomObject()},this.addRandomObject=function(){var t=new e(p);t.color="#"+(Math.random()*16777215<<0).toString(16);var n=Math.round(Math.random()*(p.canvas.width-a)),s=Math.round(Math.random()*(p.canvas.height-a)),o=a,u=a,f=new i(n,s,o,u),l=new r(Math.random()*10-5,Math.random()*10-5);f.velocity=l,f.collideBits=1,f.mass=1,this.addObject(t,f)},this.testXCollisions=function(){d.clearObjects(),n.GRAVITY=new r(0,0),i.AIR_FRICTION=1,i.CONTACT_FRICTION=new r(1,1),s.MAX_OBJECTS_PER_QUAD=5,this.addCollidingObject(20,20,new r(20,20),new r(4,0),"#FF0000"),this.addCollidingObject(20,20,new r(40,41),new r(6,0),"#FFFF00"),this.addCollidingObject(20,20,new r(220,30),new r(0,0),"#00FF00"),this.addCollidingObject(20,20,new r(320,20),new r(-12,0),"#00FFFF"),this.addCollidingObject(20,20,new r(20,120),new r(0,0),"#000000",Number.MAX_VALUE),this.addCollidingObject(20,20,new r(120,120),new r(4,0),"#FFFF00",2),this.addCollidingObject(20,20,new r(220,120),new r(0,0),"#00FF00"),this.addCollidingObject(20,20,new r(320,120),new r(-4,0),"#00FFFF"),this.addCollidingObject(20,20,new r(420,120),new r(-20,0),"#0000FF",2)},this.testGravity=function(){d.clearObjects(),n.GRAVITY=new r(0,3),i.AIR_FRICTION=.95,s.MAX_OBJECTS_PER_QUAD=5,this.addCollidingObject(800,20,new r(0,300),new r(0,0),"#000000",Number.MAX_VALUE,3),this.addCollidingObject(20,20,new r(40,20),new r(0,0),"#FF0000",1,1),this.addCollidingObject(20,20,new r(40,160),new r(0,-20),"#FFFF00",1,1),this.addCollidingObject(20,20,new r(80,160),new r(20,-20),"#00FF00",1,1)},this.addCollidingObject=function(t,n,r,s,o,u,a){var f=new e(p);f.color=o;var l=new i(r.x,r.y,t,n);return l.velocity=s,l.mass=u||1,l.collideBits=a||1,this.addObject(f,l)},this.addObject=function(e,n){var r=new t(e,n);return n.addEventListener(u.COLLIDE,b),n.addEventListener(u.INTERSECT,w),v.push(r),d.addObject(n),r},this.nextFrame=function(){undefined!==c&&(c--,0==c&&(this.pause=!0,c=undefined,h&&(h(),h=undefined))),d.updatePhysic(),p.clearRect(0,0,p.canvas.width,p.canvas.height),this.drawQuadTrees(),$.each(v,function(){this.updateView()})},this.updateLevel=function(){this.pause||this.nextFrame()},this.playNextFrames=function(e,t){c=e,this.pause=!1,h=t},this.drawQuadTrees=function(){var e=d.getQuadTrees(),t;for(var n=0,r=e.length;t=e[n],n<r;n++)p.strokeStyle="#ff0000",p.strokeRect(t.rect.position.x,t.rect.position.y,t.rect.size.x,t.rect.size.y),0!=t.objects.length&&(p.fillStyle="#ff0000",p.textBaseline="top",p.fillText(t.objects.length,t.rect.position.x+8,t.rect.position.y+8))},this.clearLevel(),setInterval(function(){l.updateLevel()},1e3/30)};return f.EVENT_COUNT_UPDATE="eventCountUpdate",augment(f,o),f}),define("app/TestManager",["app/LevelController"],function(e){var t=function(t){var n=$('<div id="canvas_container"></div>');t.append(n);var r=$('<canvas id="testCanvas" width="800" height="600"></canvas>');if(!r[0].getContext||!r[0].getContext("2d")){var i=$("<div class='canvas-support-msg'><a href='http://caniuse.com/#search=canvas' target='_blank'>The Canvas is not supported by your browser.</a></div>");n.append(i);return}n.append(r);var s=r[0].getContext("2d"),o=new e(s),u=100,a=$('<div id="radio_container"></div>'),f=$('<input id="gravity_test" type="radio" name="test" value="gravity"/>Gravity Test</br>'),l=$('<input id="x_collision_test" type="radio" name="test" value="collisions"/>X Collision Test</br>'),c=$('<input id="random_objects_test" type="radio" name="test" value="random"/>Random Objects Test</br>');a.append(f),a.append(l),a.append(c),t.append(a);var h=$('<div id="button_container"></div>'),p=$('<div id="next" class="button-icon"></div>'),d=$('<div id="pause" class="button-icon"></div>'),v=$('<div id="play" class="button-icon"></div>'),m=$('<div id="reset" class="button-icon"></div>');h.append(m),h.append(p),h.append(d),h.append(v),t.append(h);var g=$('<div id="event_count_container"></div>'),y=$('<p>Collide <span id="collide_count">0</span></p>'),b=$('<p>Intersect <span id="intersect_count">0</span></p>');g.append(y),g.append(b),t.append(g);var w=function(){T(),C(),o.testGravity(),N()},E=function(){T(),C(),o.testXCollisions(),N()},S=function(){T(),C(),o.addRandomObjects(u),N()},x=function(){o.playNextFrames(300)},T=function(){o.pause=!0},N=function(){o.nextFrame()},C=function(){o.clearLevel()},k=function(){$("input[name=test]:checked").click()},L=function(e){var t=e.data.collide,n=e.data.intersect;$("#collide_count").html(t),$("#intersect_count").html(n)};d.click(T),v.click(x),p.click(N),m.click(k),f.click(w),l.click(E),c.click(S),o.addEventListener(e.EVENT_COUNT_UPDATE,L),f.click()};return t}),require(["app/TestManager"],function(e){new e($("#physic_test_container"))}),define("app/main",function(){})